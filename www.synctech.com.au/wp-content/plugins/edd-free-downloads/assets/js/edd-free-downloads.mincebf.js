jQuery(document.body).ready((function(e){"use strict";var d=e(document.body);function o(){e(".edd-free-downloads-modal-wrapper .edd-loading").hide(),e(".edd-free-downloads-modal-wrapper").fadeOut(250),e("#edd-free-downloads-modal").hide().html(""),e("body").removeClass("edd-frozen")}if(isMobile.any){var a=e('a[href="#edd-free-download-modal"]');a.attr("data-download-id")&&a.attr("href",edd_free_downloads_vars.mobile_url+"&download_id="+a.attr("data-download-id")),d.on("click","a.edd-free-download",(function(d){d.preventDefault(),e('input[name="edd_free_download_email"]').focus(),e('input[name="edd_free_download_email"]').select(),window.location.href=e(this).attr("href")})),r(),d.removeClass("edd-frozen"),d.on("click",".edd-free-download-cancel",(function(){return parent.history.back(),!1}))}else d.on("click","a.edd-free-download",(function(a){a.preventDefault();var l=e(this).data("download-id"),s=[],i=e(this).parent().parent().find('input[name="edd_options[price_id][]"]');i.length>0&&i.each((function(){e(this).parent().parent().find('input[name="edd_options[price_id][]"]').each((function(){(e(this).prop("checked")||"hidden"===e(this).attr("type"))&&s.push(e(this).val().toString())}))})),e(".edd-free-downloads-modal-wrapper").fadeIn(250),e(".edd-free-downloads-modal-wrapper .edd-loading").show(),e.ajax({url:edd_free_downloads_vars.ajaxurl,type:"GET",data:{action:"edd_free_downloads_get_modal",download_id:l,price_ids:s,edd_is_mobile:edd_free_downloads_vars.edd_is_mobile,require_name:edd_free_downloads_vars.require_name,success_page:edd_free_downloads_vars.success_page},success:function(a){e("#edd-free-downloads-modal").prepend(a).fadeIn(250),e(".edd-free-downloads-modal-wrapper .edd-loading").hide(),e(".edd-free-downloads-modal-wrapper .edd-free-downloads-modal-close").on("click",(function(){o()})),e("#edd-free-downloads-modal").on("click","a.edd-free-downloads-direct-download-link",(function(d){d.preventDefault(),n(e(this))})),e("#edd-free-downloads-modal").on("click",(function(e){e.stopPropagation()})),e("#edd-free-downloads-modal").parent(".edd-free-downloads-modal-wrapper").on("click",(function(){o()})),d.on("keypress",".edd-free-download-field",(function(d){if(13===d.which)return e(".edd-free-download-submit").click(),!1})),d.on("keypress",".edd-free-downloads-modal-close",(function(d){if(13===d.which||32===d.which)return e(".edd-free-downloads-modal-close").click(),!1})),d.on("keyup",(function(e){27===e.keyCode&&o()})),r()}})}));function r(){var a=e("#edd_free_download_form");d.addClass("edd-frozen"),a.find("input").first().focus(),a.on("click",".edd-free-download-submit",(function(d){e(".edd-free-download-errors").css("display","none"),e("#edd-free-download-error-processing").empty().css("display","none");var r,n,l,s,i=0,t=a.find('input[name="edd_free_download_email"]');if(""===t.val()?(e(".edd-free-download-errors").show(),e("#edd-free-download-error-email-required").css("display","block"),i++,d.preventDefault()):(e("#edd-free-download-error-email-required").css("display","none"),/^((([A-Za-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([A-Za-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([A-Za-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([A-Za-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([A-Za-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([A-Za-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([A-Za-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([A-Za-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([A-Za-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([A-Za-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/.test(t.val())?e("#edd-free-download-error-email-invalid").css("display","none"):(e(".edd-free-download-errors").show(),e("#edd-free-download-error-email-invalid").css("display","block"),i++,d.preventDefault())),"true"===edd_free_downloads_vars.require_name){var u=e('#edd_free_download_form input[name="edd_free_download_fname"]'),f=e('#edd_free_download_form input[name="edd_free_download_lname"]');""===u.val()?(e(".edd-free-download-errors").show(),e("#edd-free-download-error-fname-required").css("display","block"),i++,d.preventDefault()):e("#edd-free-download-error-fname-required").css("display","none"),""===f.val()?(e(".edd-free-download-errors").show(),e("#edd-free-download-error-lname-required").css("display","block"),i++,d.preventDefault()):e("#edd-free-download-error-lname-required").css("display","none")}if("true"===edd_free_downloads_vars.user_registration&&(r=e('input[name="edd_free_download_username"]'),n=e('input[name="edd_free_download_pass"]'),l=e('input[name="edd_free_download_pass2"]'),s="1"===edd_free_downloads_vars.guest_checkout_disabled,""===r.val()&&s&&(e("#edd-free-download-error-username-required").css("display","block"),i++),""!==n.val()||!s&&""===r.val()||(e("#edd-free-download-error-password-required").css("display","block"),i++),""!==l.val()||!s&&""===r.val()||(e("#edd-free-download-error-password2-required").css("display","block"),i++),""!==n.val()&&""!==l.val()&&(n.val()===l.val()||!s&&""===r.val()?e("#edd-free-download-error-password-unmatch").css("display","none"):(e("#edd-free-download-error-password-unmatch").css("display","block"),i++))),e("#edd-free-download-privacy-agreement").length&&!e("#edd-free-download-privacy-agreement").is(":checked")?(i++,e("#edd-free-download-error-privacy-policy").css("display","block")):e("#edd-free-download-error-privacy-policy").css("display","none"),0===i){var c=e(".edd-free-download-submit span").html();if(e(".edd-free-download-submit span").html(edd_free_downloads_vars.download_loading),e(".edd-free-download-submit span").append('<i class="edd-icon-spinner edd-icon-spin"></i>'),e(".edd-free-download-submit").attr("disabled","disabled"),"1"===edd_free_downloads_vars.email_verification){d.preventDefault();var _=e("#edd_free_download_form").serialize();e.ajax({url:edd_free_downloads_vars.ajaxurl,type:"POST",data:_,success:function(d){let o=d;d.data&&d.data.message.length&&(o=d.data.message),d.success?(e(".edd-free-downloads-verification-message").html(o).fadeIn(),e(".edd-free-downloads-verification-message-wrapper").removeClass("edd-alert-info").addClass("edd-alert-success",250),e(".edd-free-download-submit").hide(),e(".edd-free-download-cancel").hide()):(e(".edd-free-download-errors").css("display","block"),e("#edd-free-download-error-processing").html(o).css("display","block"),e(".edd-free-download-submit").removeAttr("disabled"),e(".edd-free-download-submit span").html(c))}})}else e("#edd_free_download_form").submit(),"default"!=edd_free_downloads_vars.on_complete_handler&&"redirect"!=edd_free_downloads_vars.on_complete_handler&&setTimeout((function(){o()}),edd_free_downloads_vars.on_complete_delay)}else e(".edd-free-download-errors").css("display","block"),e(".edd-free-download-submit").removeAttr("disabled"),d.preventDefault()})),a.find(".edd_terms_links").on("click",(function(d){d.preventDefault();const o=e(this).parent();o.prev(".edd-terms").slideToggle(),o.find(".edd_terms_links").toggle()}))}function n(d){var a=[],r=d.parent().parent().find('input[name="edd_free_download_id"]').val();r||(r=d.parent().parent().find(".edd-free-download").data("download-id")),r||(r=d.data("download-id")),d.parent().parent().find('input[name="edd_free_download_price_id[]"]').length>0?d.parent().parent().find('input[name="edd_free_download_price_id[]"]').each((function(){a.push(e(this).val().toString())})):d.parent().parent().find('input[name="edd_options[price_id][]"]:checked').length>0&&d.parent().parent().find('input[name="edd_options[price_id][]"]:checked').each((function(){a.push(e(this).val().toString())}));var n=window.location.href;-1!==n.indexOf("?")?n+="&":n+="?",isMobile.any||o(),n=n+"edd_action=free_downloads_process_download&download_id="+r,a.length>0&&(n=n+"&price_ids="+a),window.location=n}d.on("click","a.edd-free-downloads-direct-download-link",(function(d){d.preventDefault(),n(e(this))}))}));